name: Discord Webhook Test

on:
  workflow_dispatch:  # This allows manual triggering from the GitHub UI

jobs:
  simulate-task:
    runs-on: ubuntu-latest
    steps:
      - name: Simulate Return
        run: exit 0

  send-discord-message:
    needs: simulate-task
    if: always()
    runs-on: ubuntu-latest
    steps:
    - uses: "hugoalh/send-discord-webhook-ghaction@v7.0.0"
      with:
        key: "${{secrets.DISCORD_WEBHOOK_URL}}"
        username: "Webhook"
        avatar_url: "https://i.imgur.com/4M34hi2.png"
        content: "Text message. Up to 2000 characters."
        embeds: |
          [
            {
              "author": {
                "name": "Birdieâ™«",
                "url": "https://www.reddit.com/r/cats/",
                "icon_url": "https://i.imgur.com/R66g1Pe.jpg"
              },
              "title": "Title",
              "url": "https://google.com/",
              "description": "${{ needs.simulate-task.result == 'success' && 'Job Succeeded' || 'Job Failed' }}",
              "color": 15258703,
              "fields": [
                {
                  "name": "Text",
                  "value": "More text",
                  "inline": true
                },
                {
                  "name": "Even more text",
                  "value": "Yup",
                  "inline": true
                },
                {
                  "name": "Use `\"inline\": true` parameter, if you want to display fields in the same line.",
                  "value": "okay..."
                },
                {
                  "name": "Thanks!",
                  "value": "You're welcome :wink:"
                }
              ],
              "thumbnail": {
                "url": "https://upload.wikimedia.org/wikipedia/commons/3/38/4-Nature-Wallpapers-2014-1_ukaavUI.jpg"
              },
              "image": {
                "url": "https://upload.wikimedia.org/wikipedia/commons/5/5a/A_picture_from_China_every_day_108.jpg"
              },
              "footer": {
                "text": "Woah! So cool! :smirk:",
                "icon_url": "https://i.imgur.com/fKL31aD.jpg"
              }
            }
          ]
      # - name: Post Discord Webhook
      #   uses: tsickert/discord-webhook@v6.0.0
      #   with:
      #     webhook-url: ${{ secrets.DISCORD_WEBHOOK_URL }}
      #     username: GopherMaps Data
      #     avatar-url: https://github.com/ryan-roche/gophermaps-data/blob/41aff9bce9af2257665f8393c372d84f7fc5826a/webhook-icons/gw-data.png?raw=true
      #     embed-title: ${{ needs.simulate-task.result == 'success' && 'Job Succeeded' || 'Job Failed' }}
      #     embed-url: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}
      #     embed-description: ${{ needs.simulate-task.result == 'success' && 'Manifest generated successfully' || 'TODO add error logs' }}
      #     embed-author-name: "Generate manifest.json"
      #     embed-author-icon-url: "https://github.com/github.png"
      #     embed-author-url: "https://github.com/ryan-roche/gophermaps-data/actions/workflows/manifest-generator.yml"
      #     embed-thumbnail-url: "https://github.com/actions-user.png"
      #     embed-color: ${{ needs.simulate-task.result == 'success' && 4029719 || 12845056 }}
